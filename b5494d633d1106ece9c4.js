function _readOnlyError(t){throw new TypeError('"'+t+'" is read-only')}var DIRECTION={IDLE:0,UP:1,DOWN:2,LEFT:3,RIGHT:4},rounds=[5,5,3,3,2],colors=["#1abc9c","#2ecc71","#3498db","#e74c3c","#9b59b6"],Ball={new:function(t){return{width:18,height:18,x:this.canvas.width/2-9,y:this.canvas.height/2-9,moveX:DIRECTION.IDLE,moveY:DIRECTION.IDLE,speed:t||9}}},Paddle={new:function(t){return{width:18,height:70,x:"left"===t?150:this.canvas.width-150,y:this.canvas.height/2-35,score:0,move:DIRECTION.IDLE,speed:10}}};function movePlayerBar(t){Pong.player.y=1.75*(t.clientY-Pong.player.height/.22)}var Game={initialize:function(){this.canvas=document.querySelector("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=2e3,this.canvas.height=600,this.canvas.style.width="100%",this.canvas.style.height="auto",this.canvas.style.border="solid 1px #22222233",this.canvas.style.borderRadius="5px",this.canvas.style.boxShadow="0 0 10px #22222233",this.player=Paddle.new.call(this,"left"),this.paddle=Paddle.new.call(this,"right"),this.ball=Ball.new.call(this),this.paddle.speed=8,this.running=this.over=!1,this.turn=this.paddle,this.timer=this.round=0,this.color="#f5f5f5",Pong.menu(),Pong.listen()},endGameMenu:function(t){Pong.context.font="50px Courier New",Pong.context.fillStyle=this.color,Pong.context.fillRect(Pong.canvas.width/2-350,Pong.canvas.height/2-48,700,100),Pong.context.fillStyle="#222;",Pong.context.fillText(t,Pong.canvas.width/2,Pong.canvas.height/2+15),setTimeout((function(){Object.assign({},Game),_readOnlyError("Pong"),Pong.initialize()}),3e3)},menu:function(){Pong.draw(),this.context.font="50px Courier New",this.context.fillStyle=this.color,this.context.fillRect(this.canvas.width/2-350,this.canvas.height/2-48,700,100),this.context.fillStyle="#222;",this.context.fillText("Press any key to begin",this.canvas.width/2,this.canvas.height/2+15)},update:function(){this.over||(this.ball.x<=0&&Pong._resetTurn.call(this,this.paddle,this.player),this.ball.x>=this.canvas.width-this.ball.width&&Pong._resetTurn.call(this,this.player,this.paddle),this.ball.y<=0&&(this.ball.moveY=DIRECTION.DOWN),this.ball.y>=this.canvas.height-this.ball.height&&(this.ball.moveY=DIRECTION.UP),this.player.move===DIRECTION.UP?this.player.y-=this.player.speed:this.player.move===DIRECTION.DOWN&&(this.player.y+=this.player.speed),Pong._turnDelayIsOver.call(this)&&this.turn&&(this.ball.moveX=this.turn===this.player?DIRECTION.LEFT:DIRECTION.RIGHT,this.ball.moveY=[DIRECTION.UP,DIRECTION.DOWN][Math.round(Math.random())],this.ball.y=Math.floor(Math.random()*this.canvas.height-200)+200,this.turn=null),this.player.y<=0?this.player.y=0:this.player.y>=this.canvas.height-this.player.height&&(this.player.y=this.canvas.height-this.player.height),this.ball.moveY===DIRECTION.UP?this.ball.y-=this.ball.speed/1.5:this.ball.moveY===DIRECTION.DOWN&&(this.ball.y+=this.ball.speed/1.5),this.ball.moveX===DIRECTION.LEFT?this.ball.x-=this.ball.speed:this.ball.moveX===DIRECTION.RIGHT&&(this.ball.x+=this.ball.speed),this.paddle.y>this.ball.y-this.paddle.height/2&&(this.ball.moveX===DIRECTION.RIGHT?this.paddle.y-=this.paddle.speed/1.5:this.paddle.y-=this.paddle.speed/4),this.paddle.y<this.ball.y-this.paddle.height/2&&(this.ball.moveX===DIRECTION.RIGHT?this.paddle.y+=this.paddle.speed/1.5:this.paddle.y+=this.paddle.speed/4),this.paddle.y>=this.canvas.height-this.paddle.height?this.paddle.y=this.canvas.height-this.paddle.height:this.paddle.y<=0&&(this.paddle.y=0),this.ball.x-this.ball.width<=this.player.x&&this.ball.x>=this.player.x-this.player.width&&this.ball.y<=this.player.y+this.player.height&&this.ball.y+this.ball.height>=this.player.y&&(this.ball.x=this.player.x+this.ball.width,this.ball.moveX=DIRECTION.RIGHT),this.ball.x-this.ball.width<=this.paddle.x&&this.ball.x>=this.paddle.x-this.paddle.width&&this.ball.y<=this.paddle.y+this.paddle.height&&this.ball.y+this.ball.height>=this.paddle.y&&(this.ball.x=this.paddle.x-this.ball.width,this.ball.moveX=DIRECTION.LEFT)),this.player.score===rounds[this.round]?rounds[this.round+1]?(this.color=this._generateRoundColor(),this.player.score=this.paddle.score=0,this.player.speed+=.5,this.paddle.speed+=1,this.ball.speed+=1,this.round+=1):(this.over=!0,setTimeout((function(){Pong.endGameMenu("Winner!")}),1e3)):this.paddle.score===rounds[this.round]&&(this.over=!0,setTimeout((function(){Pong.endGameMenu("Game Over!")}),1e3))},draw:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle=this.color,this.context.fillRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle="#222;",this.context.fillStyle="#222",this.context.fillRect(this.player.x,this.player.y,this.player.width,this.player.height),this.context.fillRect(this.paddle.x,this.paddle.y,this.paddle.width,this.paddle.height),Pong._turnDelayIsOver.call(this)&&this.context.fillRect(this.ball.x,this.ball.y,this.ball.width,this.ball.height),this.context.beginPath(),this.context.setLineDash([7,15]),this.context.moveTo(this.canvas.width/2,this.canvas.height-140),this.context.lineTo(this.canvas.width/2,140),this.context.lineWidth=10,this.context.strokeStyle="#222;",this.context.stroke(),this.context.font="100px Courier New",this.context.textAlign="center",this.context.fillText(this.player.score.toString(),this.canvas.width/2-300,200),this.context.fillText(this.paddle.score.toString(),this.canvas.width/2+300,200),this.context.font="30px Courier New",this.context.fillText("Round "+(Pong.round+1),this.canvas.width/2,35),this.context.font="40px Courier",this.context.fillText(rounds[Pong.round]?rounds[Pong.round]:rounds[Pong.round-1],this.canvas.width/2,100)},loop:function(){Pong.update(),Pong.draw(),Pong.over||requestAnimationFrame(Pong.loop)},listen:function(){document.addEventListener("keydown",(function(t){13===t.keyCode&&(Pong.running=!Pong.running,Pong.over=!Pong.running,document.body.style.cursor=Pong.running?"none":"default",Pong.running?(document.addEventListener("mousemove",movePlayerBar),window.requestAnimationFrame(Pong.loop)):(document.removeEventListener("mousemove",movePlayerBar),window.cancelAnimationFrame(Pong.loop)))}))},_resetTurn:function(t,e){this.ball=Ball.new.call(this,this.ball.speed),this.turn=e,this.timer=(new Date).getTime(),t.score++},_turnDelayIsOver:function(){return(new Date).getTime()-this.timer>=1e3},_generateRoundColor:function(){var t=colors[Math.floor(Math.random()*colors.length)];return t===this.color?Pong._generateRoundColor():t}},Pong=Object.assign({},Game);export default Pong;